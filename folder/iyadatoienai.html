<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <title>イヤだと言えない地味系少女</title>
    <style>
        body {
            background-color: pink;
        }

        h1 {
            text-align: center;
        }

        .comics {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        a {
            text-decoration: none;
            color: black;
        }

        .comic-img {
            width: 300px;
            height: 450px;
            object-fit: cover;
            display: block;
            border-radius: 8px;
        }

        .highlight-group {
            border: 4px solid #000;
            /* グループ用の枠 */
            box-sizing: border-box;
        }

        /* その他既存スタイル */
        .pagetop {
            height: 125px;
            width: 125px;
            position: fixed;
            right: 30px;
            bottom: 30px;
            background: #fff;
            border: solid 2px #000;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }

        .pagetop__arrow {
            height: 30px;
            width: 30px;
            border-top: 3px solid #000;
            border-right: 3px solid #000;
            transform: translateY(20%) rotate(-45deg);
        }
    </style>
</head>


<body>
    <a class="pagetop" href="#">
        <div class="pagetop__arrow"></div>
    </a>

    <a href="https://yasha84.github.io/Hmanga/">
        <h1>トップへ戻る</h1>
    </a>


    <label for="dropdown">並び替え:</label>
    <select id="dropdown"></select>


    <label for="search">タグ検索</label>
    <select id="search"></select>


    <div id="box" class="comics"></div>

    <script>

        document.addEventListener("DOMContentLoaded", function () {
            const dropdownSelect = document.getElementById("dropdown");

            const sortOptions = [
                { value: "default", text: "デフォルト" },
                { value: "name", text: "作品名順" },
                { value: "auther", text: "作者名順" }
            ];

            sortOptions.forEach(option => {
                const optionElement = document.createElement("option");
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                dropdownSelect.appendChild(optionElement);
            });
        });



        document.addEventListener("DOMContentLoaded", function () {
            const searchSelect = document.getElementById("search");

            const searchOptions = [
                { value: "all", text: "すべて" },
                { value: "boy", text: "男攻め" },
                { value: "girl", text: "女攻め" },
                { value: "both", text: "男女攻め" },
                { value: "oneshota", text: "おねショタ" },
                { value: "hitomi", text: "hitomi" },
                { value: "none", text: "hitomi以外" },
                { value: "bath", text: "風呂" },
                { value: "water", text: "プール、海" },
                { value: "school", text: "学校" },
                { value: "???", text: "???" }
            ];

            searchOptions.forEach(option => {
                const optionElement = document.createElement("option");
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                searchSelect.appendChild(optionElement);
            });
        });


        document.addEventListener("DOMContentLoaded", function () {
            const tableElement = document.getElementById("box");
            const authorSelect = document.getElementById("search");
            const sortSelect = document.getElementById("dropdown");

            const comics = [

                ["イヤだと言えない地味系少女と田舎の叔父さん",
                    "https://hitomi.la/reader/2343134.html#1",
                    "https://livedoor.blogimg.jp/z2qdee4ylnia/imgs/8/8/88de30cf.jpg",
                    "F宅",
                    ["boy", "hitomi"]
                ],

                ["イヤだと言えない地味系少女と田舎の叔父さん2",
                    "https://hitomi.la/reader/2700003.html#1",
                    "https://ecdnimg.toranoana.jp/ec/img/04/0031/09/64/040031096489-1p.jpg",
                    "F宅",
                    ["boy", "hitomi", "bath"]
                ],

                ["イヤだと言えない地味系少女とあかすりエステ",
                    "https://hitomi.la/reader/2139405.html#1",
                    "https://melonbooks.akamaized.net/user_data/packages/resize_image.php?image=232000000448.jpg",
                    "F宅",
                    ["boy", "hitomi"]
                ],

                ["イヤだと言えない地味系少女修学旅行総集編",
                    "https://hitomi.la/reader/2126231.html#1",
                    "https://ebook-assets.dmm.co.jp/digital/e-book/b164aisis04639/b164aisis04639pl.jpg",
                    "F宅",
                    ["boy", "hitomi", "bath", "school"]
                ],

                ["イヤだと言えない地味系少女と貸切温泉",
                    "https://hitomi.la/reader/2819368.html#1",
                    "https://bookmate-net.com/up/ec/pkg/lg_43_20240116101523_fe3a52.jpg",
                    "F宅",
                    ["boy", "hitomi", "bath"]
                ]

            ];

            let currentFilter = "all";
            let currentSort = "default";

            const callback = function ([name, link, image, author, tags]) {
                const hasgroup = tags.includes("group");
                const className = `comic-img${hasgroup ? ' highlight-group' : ''}`;

                return `
          <a href="${link}" target="_blank" title="${name}">
            <img src="${image}" alt="${name}" class="${className}" />
          </a>
        `;
            };

            const getFilteredSortedData = () => {
                let filtered = currentFilter === "all"
                    ? [...comics]
                    : comics.filter(comic => {
                        if (currentFilter === "none") {
                            // 特定のタグが付いていない場合
                            return !comic[4].includes("hitomi");
                        }
                        return comic[4].includes(currentFilter); // 通常のタグ絞り込み
                    });

                if (currentSort === "name") {
                    filtered.sort((a, b) => a[0].localeCompare(b[0], "ja"));
                } else if (currentSort === "auther") {
                    filtered.sort((a, b) => a[3].localeCompare(b[3], "ja"));
                }

                return filtered;
            };

            const render = () => {
                const data = getFilteredSortedData();
                tableElement.innerHTML = data.map(callback).join("");
            };

            authorSelect.addEventListener("change", () => {
                currentFilter = authorSelect.value;
                render();
            });

            sortSelect.addEventListener("change", () => {
                currentSort = sortSelect.value;
                render();
            });

            render();


        });


    </script>
</body>

</html>
