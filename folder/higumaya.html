<!DOCTYPE html>
<html>

<head>
  <base target="_top">
  <title>ひぐま屋</title>
  <style>
    /* 全体の基本 */
body {
  background-color: pink;
  margin: 0;
  font-family: sans-serif;
}

h1 {
  text-align: center;
}

label{
  font-size: 30px;
}

select{
  width: 300px;
  height: 40px;
  font-size: 30px;
}

/* 漫画カード全体のレイアウト */
.comics {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 20px;
  padding: 10px;
}

/* リンク装飾なし */
a {
  text-decoration: none;
  color: inherit;
}

/* 画像 */
.comic-img {
  width: 100%;
  height: 450px;
  object-fit: cover;
  display: block;
  border-radius: 8px;
}

/* グループ用の枠 */
.highlight-group {
  border: 4px solid #000;
  box-sizing: border-box;
}

/* 漫画カード本体 */
.comic-card {
  position: relative;
  display: inline-block;
  width: 280px;       /* デフォルトPC幅 */
  box-sizing: border-box; /* paddingやborderを幅に含める */
}

/* 画像下に重ねるタイトル・作者 */
.comic-title {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;              /* 画像幅に合わせる */
  background: rgba(0, 0, 0, 0.65); /* 半透明背景 */
  color: #fff;
  padding: 8px;
  box-sizing: border-box;
  text-align: left;
  display: flex;
  flex-direction: column; /* タイトルと作者を縦に並べる */
}

/* タイトル */
.comic-title .title {
  font-weight: bold;
  margin: 0 0 2px 0;
  white-space: nowrap;       /* 省略表示 */
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 作者名 */
.comic-title .author {
  font-size: 12px;
  opacity: 0.85;
  margin: 0;
  white-space: nowrap;       /* 省略表示 */
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ページトップボタン */
.pagetop {
  height: 125px;
  width: 125px;
  position: fixed;
  right: 30px;
  bottom: 30px;
  background: #fff;
  border: solid 2px #000;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 2;
}

.pagetop__arrow {
  height: 30px;
  width: 30px;
  border-top: 3px solid #000;
  border-right: 3px solid #000;
  transform: translateY(20%) rotate(-45deg);
}

/* スマホ対応 */
@media (max-width: 600px) {
  select {
    width: 100%;
    font-size: 20px;
    padding: 12px;
  }

  .comic-card {
    width: 100%; /* 横幅いっぱい */
  }

  .comic-title {
    font-size: 16px;
    padding: 10px;
  }

  .comic-title .title {
    font-size: 16px;
  }

  .comic-title .author {
    font-size: 14px;
  }
}

  </style>
</head>

<body>

  <a href="https://yasha84.github.io/Hmanga/">
        <h1>トップへ戻る</h1>
    </a>

  <label for="dropdown">並び替え:</label>
  <select id="dropdown"></select>

  <label for="search">タグ検索</label>
  <select id="search"></select>

  <div id="box" class="comics"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const dropdownSelect = document.getElementById("dropdown");
      const sortOptions = [
        { value: "default", text: "デフォルト" },
        { value: "name", text: "作品名順" },
        { value: "auther", text: "作者名順" }
      ];
      sortOptions.forEach(option => {
        const optionElement = document.createElement("option");
        optionElement.value = option.value;
        optionElement.textContent = option.text;
        dropdownSelect.appendChild(optionElement);
      });

      const searchSelect = document.getElementById("search");
      const searchOptions = [
        { value: "all", text: "すべて" },
        { value: "boy", text: "男攻め" },
        { value: "girl", text: "女攻め" },
        { value: "both", text: "男女攻め" },
        { value: "oneshota", text: "おねショタ" },
        { value: "hitomi", text: "hitomi" },
        { value: "none", text: "hitomi以外" },
        { value: "bath", text: "風呂" },
        { value: "water", text: "プール、海" },
        { value: "school", text: "学校" },
      ];
      searchOptions.forEach(option => {
        const optionElement = document.createElement("option");
        optionElement.value = option.value;
        optionElement.textContent = option.text;
        searchSelect.appendChild(optionElement);
      });

      const tableElement = document.getElementById("box");
      const authorSelect = document.getElementById("search");
      const sortSelect = document.getElementById("dropdown");

            const comics = [

                ["お姉ちゃんの友達がエッチな人ばかりだから",
                    "https://yasha84.github.io/Hmanga/contents/sisterfriends",
                    "https://res.booklive.jp/101091950/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    "oneshota"
                ],

                ["混浴温泉で年上のお姉さんにいっぱい射精させてもらう話",
                    "https://yasha84.github.io/Hmanga/contents/hotspring",
                    "https://res.booklive.jp/101054010/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    ["oneshota", "bath"]
                ],

                ["とある学校の筆下ろし事情",
                    "https://yasha84.github.io/Hmanga/contents/village",
                    "https://m.media-amazon.com/images/I/71e-YHkybML._UF350,350_QL50_.jpg",
                    "ひぐま屋",
                    ["oneshota", "school"]
                ],

                ["もし海辺でエッチなお姉さんと出会ったら",
                    "https://hitomi.la/reader/2447590.html#1",
                    "https://doujin-assets.dmm.co.jp/digital/comic/d_259735/d_259735pr.jpg",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "water"]
                ],

                ["おっぱいを触らせてくれる家庭教師のおねえさんの話",
                    "https://yasha84.github.io/Hmanga/contents/hometeacher",
                    "https://res.booklive.jp/101051770/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    "oneshota"
                ],

                ["プールで出会ったおねえさんとエッチな関係になっちゃうお話",
                    "https://hitomi.la/reader/727324.html#1",
                    "https://img.bookmeter.com/book_image/SL300/86/1414160052593253.jpg",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "water"]
                ],

                ["義理の姉とすごくなかよしになった話",
                    "https://hitomi.la/reader/3134844.html#1",
                    "https://img.dlsite.jp/modpub/images2/work/doujin/RJ01344000/RJ01343788_img_main.webp",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "bath"]
                ],

            ];

            let currentFilter = "all";
      let currentSort = "default";

      const callback = function ([name, link, image, author, tags]) {
        const hasgroup = tags.includes("group");
        const className = `comic-img${hasgroup ? ' highlight-group' : ''}`;
        return `
          <a href="${link}" target="_blank" title="${name}" class="comic-card">
            <img src="${image}" alt="${name}" class="${className}" />
            <div class="comic-title">
              <p class="title">${name}</p>
              <p class="author">${author}</p>
            </div>
          </a>
        `;
      };

      const getFilteredSortedData = () => {
        let filtered = currentFilter === "all"
          ? [...comics]
          : comics.filter(comic => {
            if (currentFilter === "none") return !comic[4].includes("hitomi");
            return comic[4].includes(currentFilter);
          });

        if (currentSort === "name") filtered.sort((a, b) => a[0].localeCompare(b[0], "ja"));
        else if (currentSort === "auther") filtered.sort((a, b) => a[3].localeCompare(b[3], "ja"));

        return filtered;
      };

      const render = () => {
        const data = getFilteredSortedData();
        tableElement.innerHTML = data.map(callback).join("");
      };

      authorSelect.addEventListener("change", () => {
        currentFilter = authorSelect.value;
        render();
      });

      sortSelect.addEventListener("change", () => {
        currentSort = sortSelect.value;
        render();
      });

      render();
    });
  </script>
</body>

</html>