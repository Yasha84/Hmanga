<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <title>ひぐま屋</title>
    <style>
        body {
            background-color: pink;
        }

        h1 {
            text-align: center;
        }

        .comics {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }

        a {
            text-decoration: none;
            color: black;
        }

        .comic-img {
            width: 300px;
            height: 450px;
            object-fit: cover;
            display: block;
            border-radius: 8px;
        }

        .highlight-group {
            border: 4px solid #000;
            /* グループ用の枠 */
            box-sizing: border-box;
        }

        /* その他既存スタイル */
        .pagetop {
            height: 125px;
            width: 125px;
            position: fixed;
            right: 30px;
            bottom: 30px;
            background: #fff;
            border: solid 2px #000;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2;
        }

        .pagetop__arrow {
            height: 30px;
            width: 30px;
            border-top: 3px solid #000;
            border-right: 3px solid #000;
            transform: translateY(20%) rotate(-45deg);
        }
    </style>
</head>


<body>
    <a class="pagetop" href="#">
        <div class="pagetop__arrow"></div>
    </a>

    <a href="https://yasha84.github.io/Hmanga/">
        <h1>トップへ戻る</h1>
    </a>


    <label for="dropdown">並び替え:</label>
    <select id="dropdown"></select>


    <label for="search">タグ検索</label>
    <select id="search"></select>


    <div id="box" class="comics"></div>

    <script>

        document.addEventListener("DOMContentLoaded", function () {
            const dropdownSelect = document.getElementById("dropdown");

            const sortOptions = [
                { value: "default", text: "デフォルト" },
                { value: "name", text: "作品名順" },
                { value: "auther", text: "作者名順" }
            ];

            sortOptions.forEach(option => {
                const optionElement = document.createElement("option");
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                dropdownSelect.appendChild(optionElement);
            });
        });



        document.addEventListener("DOMContentLoaded", function () {
            const searchSelect = document.getElementById("search");

            const searchOptions = [
                { value: "all", text: "すべて" },
                { value: "boy", text: "男攻め" },
                { value: "girl", text: "女攻め" },
                { value: "both", text: "男女攻め" },
                { value: "oneshota", text: "おねショタ" },
                { value: "hitomi", text: "hitomi" },
                { value: "none", text: "hitomi以外" },
                { value: "bath", text: "風呂" },
                { value: "water", text: "プール、海" },
                { value: "school", text: "学校" },
                { value: "???", text: "???" }
            ];

            searchOptions.forEach(option => {
                const optionElement = document.createElement("option");
                optionElement.value = option.value;
                optionElement.textContent = option.text;
                searchSelect.appendChild(optionElement);
            });
        });


        document.addEventListener("DOMContentLoaded", function () {
            const tableElement = document.getElementById("box");
            const authorSelect = document.getElementById("search");
            const sortSelect = document.getElementById("dropdown");

            const comics = [

                ["お姉ちゃんの友達がエッチな人ばかりだから",
                    "https://yasha84.github.io/Hmanga/contents/sisterfriends",
                    "https://res.booklive.jp/101091950/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    "oneshota"
                ],

                ["混浴温泉で年上のお姉さんにいっぱい射精させてもらう話",
                    "https://yasha84.github.io/Hmanga/contents/hotspring",
                    "https://res.booklive.jp/101054010/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    ["oneshota", "bath"]
                ],

                ["とある学校の筆下ろし事情",
                    "https://yasha84.github.io/Hmanga/contents/village",
                    "https://m.media-amazon.com/images/I/71e-YHkybML._UF350,350_QL50_.jpg",
                    "ひぐま屋",
                    ["oneshota", "school"]
                ],

                ["もし海辺でエッチなお姉さんと出会ったら",
                    "https://hitomi.la/reader/2447590.html#1",
                    "https://doujin-assets.dmm.co.jp/digital/comic/d_259735/d_259735pr.jpg",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "water"]
                ],

                ["おっぱいを触らせてくれる家庭教師のおねえさんの話",
                    "https://yasha84.github.io/Hmanga/contents/hometeacher",
                    "https://res.booklive.jp/101051770/0001/thumbnail/2L.jpg",
                    "ひぐま屋",
                    "oneshota"
                ],

                ["プールで出会ったおねえさんとエッチな関係になっちゃうお話",
                    "https://hitomi.la/reader/727324.html#1",
                    "https://img.bookmeter.com/book_image/SL300/86/1414160052593253.jpg",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "water"]
                ],

                ["義理の姉とすごくなかよしになった話",
                    "https://hitomi.la/reader/3134844.html#1",
                    "https://img.dlsite.jp/modpub/images2/work/doujin/RJ01344000/RJ01343788_img_main.webp",
                    "ひぐま屋",
                    ["oneshota", "hitomi", "bath"]
                ],

            ];

            let currentFilter = "all";
            let currentSort = "default";

            const callback = function ([name, link, image, author, tags]) {
                const hasgroup = tags.includes("group");
                const className = `comic-img${hasgroup ? ' highlight-group' : ''}`;

                return `
          <a href="${link}" target="_blank" title="${name}">
            <img src="${image}" alt="${name}" class="${className}" />
          </a>
        `;
            };

            const getFilteredSortedData = () => {
                let filtered = currentFilter === "all"
                    ? [...comics]
                    : comics.filter(comic => {
                        if (currentFilter === "none") {
                            // 特定のタグが付いていない場合
                            return !comic[4].includes("hitomi");
                        }
                        return comic[4].includes(currentFilter); // 通常のタグ絞り込み
                    });

                if (currentSort === "name") {
                    filtered.sort((a, b) => a[0].localeCompare(b[0], "ja"));
                } else if (currentSort === "auther") {
                    filtered.sort((a, b) => a[3].localeCompare(b[3], "ja"));
                }

                return filtered;
            };

            const render = () => {
                const data = getFilteredSortedData();
                tableElement.innerHTML = data.map(callback).join("");
            };

            authorSelect.addEventListener("change", () => {
                currentFilter = authorSelect.value;
                render();
            });

            sortSelect.addEventListener("change", () => {
                currentSort = sortSelect.value;
                render();
            });

            render();


        });


    </script>
</body>

</html>
